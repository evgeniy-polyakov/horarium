(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9215:function(e,t,n){Promise.resolve().then(n.bind(n,6586))},6586:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return es}});var s,i,l=n(7437),c=n(504);function o(e){let{icon:t,hint:n,onClick:s}=e;return(0,l.jsx)("button",{className:"icon",onClick:s,title:n,children:(0,l.jsx)(c.G,{icon:t})})}var r=n(2759);class a{async load(e){let t=await new Promise(t=>{let n=new FileReader;n.addEventListener("load",e=>{var n;t(null===(n=e.target)||void 0===n?void 0:n.result)}),n.readAsText(e)});if(!t)throw Error("Cannot read file ".concat(e.name));return t}async save(e,t){let n=document.createElement("a"),s=URL.createObjectURL(new Blob([e],{type:this.mimeType}));n.href=s,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(s)}constructor(e,t){this.extension=e,this.mimeType=t}}let u=[new a("csv","text/csv")];(s=i||(i={})).Text="text",s.Table="table";class h{contains(e,t){for(let n=0;n<this.excluded.length;n+=2)if(this.excluded[n]===e&&this.excluded[n+1]===t)return!1;return this.inRange(e,t)}exclude(e,t,n,s){if("number"==typeof e&&"number"==typeof t&&void 0===n&&void 0===s)this.contains(e,t)&&this.excluded.push(e,t);else{let i="object"==typeof e,l=i?e.minRow:e,c=i?e.maxRow:null!=n?n:e,o=i?e.minCell:t,r=i?e.maxCell:null!=s?s:t;for(let e=l;e<=c;e++)for(let t=o;t<=r;t++)this.exclude(e,t)}}insert(e,t,n,s){let i=this.minRow,l=this.maxRow,c=this.minCell,o=this.maxCell,r=!1;if(0!==n){n<0&&i>=e&&i<e-n?i=e:i>=e&&(i+=n),l>=e&&(l+=n);for(let t=0;t<this.excluded.length;t+=2){let s=this.excluded[t];n<0&&s>=e&&s<e-n?s=-1:s>=e&&(s+=n),this.excluded[t]=s}i>l&&(l=i,r=!0)}if(0!==s){s<0&&c>=t&&c<t-s?c=t:c>=t&&(c+=s),o>=t&&(o+=s);for(let e=1;e<this.excluded.length;e+=2){let n=this.excluded[e];s<0&&n>=t&&n<t-s?n=-1:n>=t&&(n+=s),this.excluded[e]=n}c>o&&(o=c,r=!0)}let a=this.startRow<=this.endRow;this.startRow=a?i:l,this.endRow=a?l:i;let u=this.startCell<=this.endCell;this.startCell=u?c:o,this.endCell=u?o:c;let h=[...this.excluded];this.excluded=[];for(let e=0;e<h.length;e+=2)this.exclude(h[e],h[e+1]);r&&this.exclude(i,c,l,o)}isEmpty(){return this.excluded.length>=(1+Math.abs(this.startRow-this.endRow))*(1+Math.abs(this.startCell-this.endCell))*2}isStart(e,t){return this.startRow===e&&this.startCell===t}inRange(e,t){return(this.startRow<=this.endRow?e>=this.startRow&&e<=this.endRow:e<=this.startRow&&e>=this.endRow)&&(this.startCell<=this.endCell?t>=this.startCell&&t<=this.endCell:t<=this.startCell&&t>=this.endCell)}get minRow(){return Math.min(this.startRow,this.endRow)}get maxRow(){return Math.max(this.startRow,this.endRow)}get minCell(){return Math.min(this.startCell,this.endCell)}get maxCell(){return Math.max(this.startCell,this.endCell)}constructor(e,t,n,s){this.startRow=e,this.startCell=t,this.endRow=n,this.endCell=s,this.excluded=[]}}class d{contains(e,t){var n,s;return!(null===(n=this.draftExcluded)||void 0===n?void 0:n.contains(e,t))&&((null===(s=this.draftIncluded)||void 0===s?void 0:s.contains(e,t))||this.ranges.some(n=>n.contains(e,t)))}isFocus(e,t){return this.focus[0]===e&&this.focus[1]===t}setFocus(e,t){this.focus[0]=e,this.focus[1]=t}hasFocus(){return this.focus[0]>=0&&this.focus[1]>=0}get focusRow(){return this.focus[0]}get focusCell(){return this.focus[1]}clearFocus(){this.focus[0]=-1,this.focus[1]=-1}clearSelection(){this.ranges=[],this.draftIncluded=void 0,this.draftExcluded=void 0}selectRange(e,t,n,s,i){if(i)this.draftIncluded=new h(e,t,n,s);else{let i=new h(e,t,n,s);this.ranges.push(i),this.combineRanges(i)}}removeRange(e,t){this.ranges=this.ranges.filter(n=>!n.isStart(e,t))}excludeRange(e,t,n,s,i){if(i)this.draftExcluded=new h(e,t,n,s);else{let i=new h(e,t,n,s);this.ranges.forEach(e=>e.exclude(i)),this.clearRanges()}}commitDraft(){if(this.draftIncluded&&(this.ranges.push(this.draftIncluded),this.combineRanges(this.draftIncluded),this.draftIncluded=void 0),this.draftExcluded&&(this.ranges.forEach(e=>e.exclude(this.draftExcluded)),this.clearRanges(),this.draftExcluded=void 0),this.draftInserted){let[e,t,n,s]=this.draftInserted,[i,l]=this.focus;e>=0&&(n<0&&i>=e&&i<e-n?i=-1:i>=e&&(i+=n)),t>=0&&(s<0&&l>=t&&l<t-s?l=-1:l>=t&&(l+=s)),this.focus[0]=i,this.focus[1]=l,this.ranges.forEach(i=>i.insert(e,t,n,s)),this.clearRanges(),this.draftInserted=void 0}}insertRow(e,t){this.draftInserted=[e,-1,null!=t?t:1,0]}insertColumn(e,t){this.draftInserted=[-1,e,0,null!=t?t:1]}combineRanges(e){this.ranges.forEach(t=>{t!==e&&t.exclude(e)}),this.clearRanges()}clearRanges(){this.ranges=this.ranges.filter(e=>!e.isEmpty())}getBounds(){let e=[-1,-1,-1,-1];for(let t of this.ranges)(-1===e[0]||e[0]>t.minRow)&&(e[0]=t.minRow),(-1===e[1]||e[1]>t.minCell)&&(e[1]=t.minCell),(-1===e[2]||e[2]<t.maxRow)&&(e[2]=t.maxRow),(-1===e[3]||e[3]<t.maxCell)&&(e[3]=t.maxCell);return e}*[Symbol.iterator](){let[e,t,n,s]=this.getBounds();if(e>=0&&t>=0){let i=[-1,-1];for(let l=e;l<=n;l++)for(let e=t;e<=s;e++)this.contains(l,e)&&(i[0]=l,i[1]=e,yield i)}}copy(e){var t,n,s,i,l,c;let o=[],r=-1,a=-1,u=-1;for(let[n,s]of this)r<0&&(r=n),a<0&&(a=s),s>u&&(u=s),(null===(t=e[n])||void 0===t?void 0:t[s])!==void 0&&(void 0===o[n-r]&&(o[n-r]=[]),o[n-r][s-a]=e[n][s]);for(let e=0;e<o.length;e++){null!==(s=o[n=e])&&void 0!==s||(o[n]=[]);for(let t=0;t<u;t++)null!==(c=(i=o[e])[l=t])&&void 0!==c||(i[l]="")}return o}paste(e,t,n,s){var i,l,c,o,r,a,u,h;e.length,e[0].length;for(let c=0;c<t.length;c++){null!==(l=e[i=c+n])&&void 0!==l||(e[i]=[]);for(let i=0;i<t[c].length;i++)""!==t[c][i]&&void 0!==t[c][i]&&(e[c+n][i+s]=t[c][i])}for(let i=0;i<n+t.length;i++){null!==(r=e[o=i])&&void 0!==r||(e[o]=[]);for(let n=0;n<s+(null===(c=t[0])||void 0===c?void 0:c.length);n++)null!==(h=(a=e[i])[u=n])&&void 0!==h||(a[u]="")}}clear(e){for(let[n,s]of(arguments.length>1&&void 0!==arguments[1]&&arguments[1],this)){var t;(null===(t=e[n])||void 0===t?void 0:t[s])!==void 0&&(e[n][s]="")}}constructor(){this.ranges=[],this.focus=[-1,-1]}}function f(e,t){let n=e.file.tableSelection;switch(t.action){case"update":return{...e,file:t.file};case"setFocus":n.setFocus(t.rowIndex,t.cellIndex);break;case"clearFocus":n.clearFocus();break;case"clearSelection":n.clearSelection();break;case"selectRange":t.clear&&n.clearSelection(),t.replace&&n.removeRange(t.range[0],t.range[1]),t.range.length>2?n.selectRange(...t.range,t.draft):n.selectRange(...t.range,...t.range,t.draft);break;case"excludeRange":t.range.length>2?n.excludeRange(...t.range,t.draft):n.excludeRange(...t.range,...t.range,t.draft);break;case"commitDraft":n.commitDraft();break;case"insertRow":n.insertRow(t.rowIndex,t.rows);break;case"insertColumn":n.insertColumn(t.columnIndex,t.columns)}return{...e}}let m=0;class x{async load(){this.file&&(this.textContent=await this.loader.load(this.file))}async save(){await this.loader.save(this.textContent,this.filename)}constructor(e){var t;if(this.file=e,this.id=++m,this.textContent="",this.selected=!1,this.editMode=i.Table,this.tableSelection=new d,this.filename=null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"untitled.csv",this.extension=this.filename.replace(/^.*\.(\w+)$/,"$1").toLowerCase(),this.loader=u.filter(e=>e.extension===this.extension)[0],!this.loader)throw Error("Unknown file extension ".concat(this.filename))}}function w(e){let{onOpen:t}=e;return(0,l.jsx)(o,{icon:r.cC_,onClick:function(){let e=document.createElement("input");e.type="file",e.multiple=!0,e.accept=u.map(e=>".".concat(e.extension,",").concat(e.mimeType)).join(","),e.onchange=async()=>{if(e.files)for(let n=0;n<e.files.length;n++){let s=new x(e.files.item(n));await s.load(),null==t||t(s)}},e.click()},hint:"Open File"})}var g=n(7188);function v(e){var t;let{item:n,onSelect:s,onRemove:i}=e,a="tab ".concat(n.selected?"selected":""," ").concat(n.editable?"editable":"");return(0,l.jsxs)("li",{className:a,children:[(0,l.jsxs)("button",{className:"label",title:null!==(t=n.hint)&&void 0!==t?t:n.name,onClick:()=>{n.selected||null==s||s()},children:[n.icon&&(0,l.jsx)("span",{className:"icon",children:(0,l.jsx)(c.G,{icon:n.icon})}),n.name&&(0,l.jsx)("span",{className:"name",children:n.name})]}),n.removable&&(0,l.jsx)(o,{icon:r.g82,hint:"Close",onClick:i})]})}function R(e){let{items:t,onRename:n,onSelect:s,onRemove:i}=e;return(0,l.jsx)("ul",{className:"tabs",children:t.map(e=>(0,l.jsx)(v,{item:e,onSelect:()=>null==s?void 0:s(e),onRemove:()=>null==i?void 0:i(e)},e.key))})}class p{get key(){return"".concat(this.file.id)}get selected(){return this.file.selected}get link(){return"/".concat(this.name)}constructor(e){this.file=e,this.name=this.file.filename,this.removable=!0,this.editable=!0}}class b{get selected(){return this.file.editMode===this.editMode}constructor(e,t,n,s){this.file=e,this.editMode=t,this.icon=n,this.hint=s,this.key=this.editMode,this.editable=!1,this.removable=!1}}function C(e){let{file:t}=e;async function n(){await t.save()}return(0,l.jsx)(o,{icon:r.kwI,onClick:n,hint:"Save File"})}function y(e){let{onOpen:t}=e;async function n(){let e=new x;await e.load(),null==t||t(e)}return(0,l.jsx)(o,{icon:r.gMD,onClick:n,hint:"New File"})}function I(e){let{filesReducer:[t,n]}=e,s=t.files,c=t.selectedFile;function o(e){n({file:e,type:"add"})}return(0,l.jsxs)("nav",{children:[(0,l.jsx)(w,{onOpen:o}),(0,l.jsx)(y,{onOpen:o}),c&&(0,l.jsx)(C,{file:c}),(0,l.jsx)(R,{items:s.map(e=>new p(e)),onSelect:e=>n({file:e.file,type:"select"}),onRemove:e=>n({file:e.file,type:"remove"})}),c&&(0,l.jsx)(R,{items:[new b(c,i.Text,g.nfZ,"Text"),new b(c,i.Table,r.DaQ,"Table")],onSelect:e=>{c.editMode=e.editMode,n({file:t.selectedFile,type:"update"})}})]})}var S=n(2265);function j(e,t){let n=e.files;switch(t.type){case"add":n.forEach(e=>e.selected=!1);let s=n.filter(e=>e.id===t.file.id)[0];s?s.selected=!0:(t.file.selected=!0,n.push(t.file));break;case"select":n.forEach(e=>e.selected=!1),t.file.selected=!0;break;case"remove":let i=n.indexOf(t.file);i>=0&&(n.splice(i,1),t.file.selected&&(i<n.length?n[i].selected=!0:i-1>=0&&(n[i-1].selected=!0)))}return{files:n,selectedFile:n.filter(e=>e.selected)[0]}}function E(e){let{file:t}=e,[n,s]=(0,S.useState)(t.textContent);return n!==t.textContent&&s(t.textContent),(0,l.jsx)("textarea",{className:"text-editor",value:n,onChange:e=>{t.textContent=e.target.value,s(e.target.value)},onScroll:e=>{}})}function k(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map(e=>"string"==typeof e?e:"object"==typeof e?Object.keys(e).filter(t=>e[t]).join(" "):"").join(" ")}function M(e){var t;let{csv:n,rowIndex:s,cellIndex:i,onEdit:c,onMenu:o,selectionReducer:[r,a],cellEditState:[u,h],mouseDownState:[d,f]}=e,[m,x]=(0,S.useState)(""),[w,g]=(0,S.useState)(!1),v=(0,S.useRef)(null),R=r.file.tableSelection,p=null===(t=n[s])||void 0===t?void 0:t[i];function b(){return u[0]===s&&u[1]===i}return m!==p&&x(p),b()&&!w&&(g(!0),function(){var e,t;let n=document.createElement("textarea"),s=()=>n.scrollHeight+2;null===(e=v.current)||void 0===e||e.append(n),null===(t=v.current)||void 0===t||t.classList.add("editing"),n.value=m,n.style.height="".concat(s(),"px"),n.focus(),n.addEventListener("blur",()=>{var e;n.value!==m&&(x(n.value),null==c||c(n.value)),n.remove(),null===(e=v.current)||void 0===e||e.classList.remove("editing"),g(!1),h([-1,-1])}),n.addEventListener("input",()=>{let e=s();n.offsetHeight<e&&(n.style.height="".concat(s(),"px"))})}()),(0,l.jsx)("td",{ref:v,className:k({selected:R.contains(s,i),focused:R.isFocus(s,i)}),onDoubleClick:function(){b()||h([s,i])},onContextMenu:function(e){!b()&&o&&o(e)},onMouseDown:function(e){if(!b()){if(f([s,i,!!e.ctrlKey&&R.contains(s,i)]),0!==e.button)a({action:"setFocus",rowIndex:s,cellIndex:i});else if(e.shiftKey){let t=R.hasFocus();t||a({action:"setFocus",rowIndex:s,cellIndex:i}),a({action:"selectRange",range:[t?R.focusRow:s,t?R.focusCell:i,s,i],clear:!e.ctrlKey,replace:!0})}else a({action:"setFocus",rowIndex:s,cellIndex:i}),e.ctrlKey&&R.contains(s,i)?a({action:"excludeRange",range:[s,i]}):a({action:"selectRange",range:[s,i],clear:!e.ctrlKey});document.activeElement instanceof HTMLElement&&document.activeElement.blur()}},onMouseUp:function(e){b()||(a({action:"commitDraft"}),f([-1,-1]))},onMouseEnter:function(e){!b()&&d[0]>=0&&d[1]>=0&&(d[2]?a({action:"excludeRange",range:[d[0],d[1],s,i],draft:!0}):a({action:"selectRange",range:[R.focusRow,R.focusCell,s,i],draft:!0,replace:!0}))},children:(0,l.jsx)("span",{children:m})})}var F=n(7026),D=n(7982);async function N(e){return new Promise((t,n)=>(0,F.Qc)(e,{relaxColumnCount:!0,relaxQuotes:!0},(e,n)=>{if(e)console.error(e),t([[""]]);else{let e=n.reduce((e,t)=>Math.max(t.length,e),0);n.forEach(t=>{for(;t.length<e;)t.push("")}),0===n.length?n=[[""]]:0===n[0].length&&n[0].push(""),t(n)}}))}async function T(e){return new Promise((t,n)=>(0,D.Pz)(e,{eof:!1},(e,n)=>{e?(console.error(e),t("")):t(n)}))}function L(e){let{csv:t,cellIndex:n,selectionReducer:[s,i],onMenu:c}=e;return(0,l.jsx)("th",{onMouseDown:function(e){if(0!==e.button)return;let l=s.file.tableSelection,c=s.file.tableSelection.focusCell;l.hasFocus()||(i({action:"setFocus",rowIndex:0,cellIndex:n}),c=n),e.shiftKey?i({action:"selectRange",range:[0,c,t.length-1,n],clear:!e.ctrlKey}):(i({action:"setFocus",rowIndex:0,cellIndex:n}),i({action:"selectRange",range:[0,n,t.length-1,n],clear:!e.ctrlKey}))},onContextMenu:c,children:function(e){let t=String.fromCharCode(65+e%26);for(;e>=26;)t=String.fromCharCode(65+(e=Math.floor(e/26)-1)%26)+t;return t}(n)})}function K(e){let{csv:t,rowIndex:n,selectionReducer:[s,i],onMenu:c}=e;return(0,l.jsx)("th",{onMouseDown:function(e){if(0!==e.button)return;let l=s.file.tableSelection,c=s.file.tableSelection.focusRow;l.hasFocus()||(i({action:"setFocus",rowIndex:n,cellIndex:0}),c=n),e.shiftKey?i({action:"selectRange",range:[c,0,n,t[n].length-1],clear:!e.ctrlKey}):(i({action:"setFocus",rowIndex:n,cellIndex:0}),i({action:"selectRange",range:[n,0,n,t[n].length-1],clear:!e.ctrlKey}))},onContextMenu:c,children:n+1})}function O(e){let{csv:t,selectionReducer:[,n]}=e;return(0,l.jsx)("th",{onClick:function(e){e.preventDefault(),n({action:"selectRange",range:[0,0,t.length-1,t[0].length-1],clear:!0})}})}function H(e){let{items:t,x:n,y:s,remove:i,viewportWidth:o,viewportHeight:a}=e,u=(0,S.useRef)(null);function h(e){var t;(null===(t=u.current)||void 0===t?void 0:t.contains(e.target))||null==i||i()}return(0,S.useEffect)(()=>(window.addEventListener("mousedown",h,!1),()=>{window.removeEventListener("mousedown",h,!1)})),(0,S.useEffect)(()=>{let e=u.current;if(e){e.style.left="0",e.style.top="0",e.querySelectorAll("ul").forEach(e=>{e.style.display="block",e.style.left="100%",e.style.right="auto",e.style.top="0",e.style.bottom="auto"});let t=e.scrollWidth,i=e.scrollHeight,l=e.offsetWidth,c=e.offsetHeight;e.querySelectorAll("ul").forEach(e=>{e.style.display="",e.style.left="",e.style.right="",e.style.top="",e.style.bottom=""}),e.style.left="".concat(n>o-l?n-l:n,"px"),e.style.top="".concat(s>a-c?s-c:s,"px"),e.classList.toggle("menu-right",n>o-t),e.classList.toggle("menu-bottom",s>a-i)}}),(0,l.jsx)("nav",{className:"menu",ref:u,style:{display:t.length>0?"block":"none"},onContextMenu:e=>e.preventDefault(),children:function e(t){return(0,l.jsx)("ul",{children:t.map((t,n)=>t.separator?(0,l.jsx)("li",{className:"separator"},n):(0,l.jsxs)("li",{onClick:()=>{var e;null==i||i(),null===(e=t.select)||void 0===e||e.call(t)},className:k(t.className,{disabled:t.disabled}),children:[(0,l.jsx)("span",{className:"icon",children:t.icon&&(0,l.jsx)(c.G,{icon:t.icon})}),(0,l.jsx)("span",{className:"name",children:t.name}),t.items&&(0,l.jsx)("span",{className:"expand",children:(0,l.jsx)(c.G,{icon:r.I4f})}),t.items&&e(t.items)]},n))})}(t)})}class _{select(){this.cellEditState[1]([this.rowIndex,this.cellIndex])}constructor(e,t,n){this.cellEditState=e,this.rowIndex=t,this.cellIndex=n,this.name="Edit",this.icon=r.TzT}}class P{get disabled(){let[e]=this.selectionReducer;return!e.file.tableSelection.contains(this.rowIndex,this.cellIndex)}constructor(e,t,n,s){this.csvState=e,this.selectionReducer=t,this.rowIndex=n,this.cellIndex=s}}class U extends P{select(){let[e,t]=this.csvState,[n]=this.selectionReducer;n.file.tableSelection.clear(e),t([...e])}constructor(...e){super(...e),this.name="Clear",this.icon=g.Vui}}class W extends P{async select(){let[e,t]=this.csvState,[n]=this.selectionReducer,s=n.file.tableSelection.copy(e);t([...e]),await navigator.clipboard.writeText(await T(s))}constructor(...e){super(...e),this.name="Copy",this.icon=g.kZ_}}class A extends W{async select(){await super.select(),new U(this.csvState,this.selectionReducer,this.rowIndex,this.cellIndex).select()}constructor(...e){super(...e),this.name="Cut",this.icon=r.DCV}}class B extends P{async select(){let[e]=this.selectionReducer,t=await navigator.clipboard.readText();if(t){let[n,s]=this.csvState,i=await N(t);e.file.tableSelection.paste(n,i,this.rowIndex,this.cellIndex),s([...n])}}get disabled(){return!1}constructor(...e){super(...e),this.name="Paste",this.icon=g.O4}}class q{select(){let[e,t]=this.csvState,n=this.rowIndex+(this.above?0:1),s=e[0].map(()=>"");e.splice(n,0,s),t([...e]);let[,i]=this.selectionReducer;i({action:"insertRow",rowIndex:n}),i({action:"commitDraft"})}constructor(e,t,n,s){this.csvState=e,this.selectionReducer=t,this.rowIndex=n,this.above=s,this.name="Insert Row ".concat(this.above?"Above":"Below"),this.icon=r.ZhI,this.className="rotate".concat(this.above?"-90":"90")}}class Z{select(){let[e,t]=this.csvState,n=this.columnIndex+(this.before?0:1);for(let t of e)t.splice(n,0,"");t([...e]);let[,s]=this.selectionReducer;s({action:"insertColumn",columnIndex:n}),s({action:"commitDraft"})}constructor(e,t,n,s){this.csvState=e,this.selectionReducer=t,this.columnIndex=n,this.before=s,this.name="Insert Column ".concat(this.before?"Before":"After"),this.icon=r.ZhI,this.className="rotate".concat(this.before?"180":"0")}}class G{select(){let[e,t]=this.csvState,n=this.rowIndex,s=e[n].slice();e.splice(n,0,s),t([...e]);let[,i]=this.selectionReducer;i({action:"insertRow",rowIndex:n+1}),i({action:"commitDraft"})}constructor(e,t,n){this.csvState=e,this.selectionReducer=t,this.rowIndex=n,this.name="Clone Row",this.icon=g.WM4}}class V{select(){let[e,t]=this.csvState,n=this.columnIndex;for(let t of e)t.splice(n,0,t[n]);t([...e]);let[,s]=this.selectionReducer;s({action:"insertColumn",columnIndex:n+1}),s({action:"commitDraft"})}constructor(e,t,n){this.csvState=e,this.selectionReducer=t,this.columnIndex=n,this.name="Clone Column",this.icon=g.WM4}}class z{select(){let[e,t]=this.csvState,n=this.rowIndex+(this.up?-1:1),s=e[this.rowIndex];e[this.rowIndex]=e[n],e[n]=s,t([...e])}get disabled(){let[e]=this.csvState;return this.up&&0===this.rowIndex||!this.up&&this.rowIndex>=e.length-1}constructor(e,t,n,s){this.csvState=e,this.selectionReducer=t,this.rowIndex=n,this.up=s,this.name="Move Row ".concat(this.up?"Up":"Down"),this.icon=this.up?r.FPD:r.r5q}}class Q{select(){let[e,t]=this.csvState,n=this.columnIndex+(this.left?-1:1);for(let t of e){let e=t[this.columnIndex];t[this.columnIndex]=t[n],t[n]=e}t([...e])}get disabled(){let[e]=this.csvState;return this.left&&0===this.columnIndex||!this.left&&this.columnIndex>=e[0].length-1}constructor(e,t,n,s){this.csvState=e,this.selectionReducer=t,this.columnIndex=n,this.left=s,this.name="Move Column ".concat(this.left?"Left":"Right"),this.icon=this.left?r.acZ:r.eFW}}class ${select(){let[e,t]=this.csvState;e.splice(this.rowIndex,1),t([...e]);let[,n]=this.selectionReducer;n({action:"insertRow",rowIndex:this.rowIndex,rows:-1}),n({action:"commitDraft"})}get disabled(){let[e]=this.csvState;return e.length<2}constructor(e,t,n){this.csvState=e,this.selectionReducer=t,this.rowIndex=n,this.name="Delete Row",this.icon=g.Vui}}class X{select(){let[e,t]=this.csvState;for(let t of e)t.splice(this.columnIndex,1);t([...e]);let[,n]=this.selectionReducer;n({action:"insertColumn",columnIndex:this.columnIndex,columns:-1}),n({action:"commitDraft"})}get disabled(){let[e]=this.csvState;return e[0].length<2}constructor(e,t,n){this.csvState=e,this.selectionReducer=t,this.columnIndex=n,this.name="Delete Column",this.icon=g.Vui}}class Y{constructor(){this.separator=!0}}class J{constructor(e){this.items=e,this.name="Row",this.icon=r.u7T}}class ee{constructor(e){this.items=e,this.name="Column",this.icon=r.rWw}}function et(e){let{file:t}=e,[n,s]=(0,S.useState)(-1),i=(0,S.useState)([]),[c,o]=i,r=(0,S.useState)([-1,-1]),[a,u]=r,h=(0,S.useState)([-1,-1]),d=(0,S.useReducer)(f,{file:t}),[m,x]=(0,S.useState)(),w=(0,S.useRef)(null);function g(){u([-1,-1])}async function v(e,n,s){c[e][n]=s,t.textContent=await T(c)}function R(e,t,n){var s,l;if(e.preventDefault(),!w.current)return;function c(){return[new G(i,d,t),new q(i,d,t,!0),new q(i,d,t,!1),new Y,new z(i,d,t,!0),new z(i,d,t,!1),new Y,new $(i,d,t)]}function o(){return[new V(i,d,n),new Z(i,d,n,!0),new Z(i,d,n,!1),new Y,new Q(i,d,n,!0),new Q(i,d,n,!1),new Y,new X(i,d,n)]}let r=t>=0&&n>=0?[new _(h,t,n),new Y,new A(i,d,t,n),new W(i,d,t,n),new B(i,d,t,n),new U(i,d,t,n),new Y,new J(c()),new ee(o())]:t>=0?c():n>=0?o():[],a=w.current.querySelector("table.content").getBoundingClientRect(),u=w.current.querySelector("table.columns").offsetHeight,f=w.current.offsetHeight;x({items:r,x:e.clientX-(null!==(s=a.x)&&void 0!==s?s:0),y:e.clientY-(null!==(l=a.y)&&void 0!==l?l:0)+u,viewportWidth:a.width,viewportHeight:f,remove:()=>x(void 0)})}return(0,S.useEffect)(()=>(a&&window.addEventListener("mouseup",g,!1),()=>{window.removeEventListener("mouseup",g,!1)})),d[0].file!==t&&(u([-1,-1]),d[1]({file:t,action:"update"})),n!==t.id&&(s(t.id),N(t.textContent).then(e=>o(e))),(0,l.jsxs)("div",{className:"table-editor",ref:w,children:[c.length>0&&(0,l.jsx)("table",{className:"columns",children:(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)(O,{csv:c,selectionReducer:d}),c[0].map((e,t)=>(0,l.jsx)(L,{cellIndex:t,csv:c,selectionReducer:d,onMenu:e=>R(e,-1,t)},t))]})})}),(0,l.jsx)("table",{className:"content",children:(0,l.jsx)("tbody",{children:c.map((e,t)=>(0,l.jsxs)("tr",{style:{zIndex:c.length-t},children:[(0,l.jsx)(K,{rowIndex:t,csv:c,selectionReducer:d,onMenu:e=>R(e,t,-1)}),e.map((e,n)=>(0,l.jsx)(M,{csv:c,rowIndex:t,cellIndex:n,selectionReducer:d,mouseDownState:r,cellEditState:h,onEdit:e=>v(t,n,e),onMenu:e=>R(e,t,n)},n))]},t))})}),m&&(0,l.jsx)(H,{...m})]})}function en(e){let{file:t}=e;return(0,l.jsxs)("article",{children:[t.editMode===i.Text&&(0,l.jsx)(E,{file:t}),t.editMode===i.Table&&(0,l.jsx)(et,{file:t})]})}function es(){let e=(0,S.useReducer)(j,{files:[]}),[t,n]=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("header",{children:(0,l.jsx)(I,{filesReducer:e})}),(0,l.jsx)("main",{children:t.selectedFile&&(0,l.jsx)(en,{file:t.selectedFile})})]})}}},function(e){e.O(0,[676,878,971,938,744],function(){return e(e.s=9215)}),_N_E=e.O()}]);